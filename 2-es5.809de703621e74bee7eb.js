function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{D6JZ:function(e,t,n){"use strict";n.r(t),n.d(t,"ProductoPageModule",(function(){return se}));var i=n("ofXK"),o=n("3Pt+"),a=n("TEn/"),r=n("tyNb"),c=n("mrSG"),s=n("fXoL"),l=n("J/xi"),b=n("XDzg"),u=n("DgPi"),d=n("a/9d"),h=n("cZdB");function g(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-item",11),s.Ub("click",(function(){s.ec(n);var e=t.$implicit;return s.Wb(2).getDetalle(e)})),s.Kb(1,"ion-icon",12),s.Mb(2,"ion-label",13),s.Mb(3,"h3"),s.ic(4),s.Lb(),s.Mb(5,"p"),s.ic(6),s.Lb(),s.Lb(),s.Lb()}if(2&e){var i=t.$implicit;s.zb(4),s.jc(i.nombre),s.zb(2),s.jc(i.descripcion)}}function p(e,t){if(1&e&&(s.Mb(0,"ion-list"),s.hc(1,g,7,2,"ion-item",10),s.Xb(2,"filter"),s.Lb()),2&e){var n=s.Wb();s.zb(1),s.bc("ngForOf",s.Yb(2,1,n.data,n.search))}}function m(e,t){1&e&&s.Kb(0,"img",18)}function f(e,t){if(1&e&&s.Kb(0,"img",19),2&e){var n=s.Wb(2);s.cc("src",n.strImage,s.fc)}}function v(e,t){if(1&e&&(s.Mb(0,"div",14),s.Mb(1,"div",15),s.hc(2,m,1,0,"img",16),s.hc(3,f,1,1,"img",17),s.Lb(),s.Lb()),2&e){var n=s.Wb();s.zb(2),s.bc("ngIf",!n.strImage),s.zb(1),s.bc("ngIf",n.strImage)}}function M(e,t){if(1&e){var n=s.Nb();s.Mb(0,"form",20),s.Ub("ngSubmit",(function(){return s.ec(n),s.Wb().saveChanges()})),s.Mb(1,"ion-item"),s.Mb(2,"ion-label",21),s.Kb(3,"ion-icon",22),s.ic(4," Descripcion: "),s.Lb(),s.Mb(5,"ion-textarea",23),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().dataForm.descripcion=e})),s.Lb(),s.Lb(),s.Mb(6,"ion-item"),s.Mb(7,"ion-label",21),s.Kb(8,"ion-icon",22),s.ic(9," Precio: "),s.Lb(),s.Mb(10,"ion-input",24),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().dataForm.precio=e})),s.Lb(),s.Lb(),s.Mb(11,"ion-item"),s.Mb(12,"ion-label",21),s.Kb(13,"ion-icon",22),s.ic(14," Costo: "),s.Lb(),s.Mb(15,"ion-input",25),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().dataForm.costo=e})),s.Lb(),s.Lb(),s.Mb(16,"ion-item"),s.Mb(17,"ion-label",21),s.Kb(18,"ion-icon",22),s.ic(19," Cantidad: "),s.Lb(),s.Mb(20,"ion-input",26),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().dataForm.cantidad=e})),s.Lb(),s.Lb(),s.Mb(21,"ion-button",27),s.Ub("click",(function(){return s.ec(n),s.Wb().libreria()})),s.Kb(22,"ion-icon",28),s.ic(23," Seleccionar Imagen "),s.Lb(),s.Mb(24,"ion-button",29),s.Kb(25,"ion-icon",30),s.ic(26," Guardar Cambios "),s.Lb(),s.Lb()}if(2&e){var i=s.Wb();s.zb(5),s.bc("ngModel",i.dataForm.descripcion),s.zb(5),s.bc("ngModel",i.dataForm.precio),s.zb(5),s.bc("ngModel",i.dataForm.costo),s.zb(5),s.bc("ngModel",i.dataForm.cantidad),s.zb(4),s.bc("disabled",i.disabledBtn)}}var L,y,k=((L=function(){function e(t,n,i,o,a,r,c){var s=this;_classCallCheck(this,e),this.loadingController=t,this.notificacionService=n,this.presentacionService=i,this.modalController=o,this.navParams=a,this.uploadFileService=r,this.camera=c,this.disabledBtn=!1,this.presentaciones=!0,this.formulario=!1,this.dataForm={id:"",producto:"",presentacion:"",descripcion:"",precio:"",costo:"",cantidad:"",imagen:""},this.getAll=function(){s.notificacionService.presentLoading("Cargando..."),s.presentacionService.getAll().subscribe((function(e){s.data=[],s.data=e,s.notificacionService.dismissLoading()}),(function(e){s.notificacionService.dismissLoading()}))}}return _createClass(e,[{key:"ngOnInit",value:function(){this.dataForm.producto=this.navParams.get("producto"),this.dataForm.id=this.navParams.get("value"),this.dataForm.id?this.getSingle(+this.dataForm.id):this.getAll()}},{key:"closeModal",value:function(e){this.modalController.dismiss(e)}},{key:"getDetalle",value:function(e){console.log(e),this.presentaciones=!1,this.formulario=!0,this.dataForm.presentacion=e.id,this.dataForm.descripcion=e.nombre}},{key:"saveChanges",value:function(){console.log(this.dataForm),this.dataForm.id?this.update():this.create()}},{key:"create",value:function(){var e=this;this.strImage&&(this.dataForm.imagen=this.strImage),this.presentacionService.createProductoPresentacion(this.dataForm).subscribe((function(t){e.closeModal(t),e.notificacionService.presentAlert("Presentaci\xf3n Agregada","La presentaci\xf3n se ha registrado exitosamente.")}),(function(t){e.notificacionService.presentToast("Lo sentimos, ha ocurrido un error intenta m\xe1s tarde.")}))}},{key:"update",value:function(){var e=this;this.strImage&&(this.dataForm.imagen=this.strImage),this.presentacionService.updateProductoPresentacion(this.dataForm).subscribe((function(t){e.closeModal(t),e.notificacionService.presentAlert("Presentaci\xf3n Actualizada","La presentaci\xf3n se ha actualizado exitosamente.")}),(function(t){e.notificacionService.presentToast("Lo sentimos, ha ocurrido un error intenta m\xe1s tarde.")}))}},{key:"getSingle",value:function(e){var t=this;this.presentaciones=!1,this.formulario=!0,this.presentacionService.getSinglePresentacion(e).subscribe((function(e){t.dataForm=e}),(function(e){}))}},{key:"libreria",value:function(){this.procesarImagen({quality:60,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,correctOrientation:!0,sourceType:this.camera.PictureSourceType.PHOTOLIBRARY})}},{key:"procesarImagen",value:function(e){var t=this;this.camera.getPicture(e).then((function(e){t.strImage="https://i.pinimg.com/originals/8e/e2/12/8ee212dac057d412972e0c8cc164deee.gif",t.uploadFileService.subirImagen(e,"Ecommerce/Producto").then((function(e){t.strImage=e.secure_url})).catch((function(e){t.notificacionService.presentToast("Lo sentimos, ha ocurrido un error intenta m\xe1s tarde.")}))}),(function(e){t.notificacionService.presentToast("Lo sentimos, servicio inhabilitado para tu dispositivo.")}))}}]),e}()).\u0275fac=function(e){return new(e||L)(s.Jb(a.T),s.Jb(l.a),s.Jb(b.a),s.Jb(a.U),s.Jb(a.W),s.Jb(u.a),s.Jb(d.a))},L.\u0275cmp=s.Db({type:L,selectors:[["app-modal-producto-presentacion"]],decls:17,vars:4,consts:[["translucent","true"],["slot","end"],[3,"click"],["slot","icon-only","name","close-circle-outline"],["collapse","condense"],["size","large"],[3,"ngModel","ngModelChange"],[4,"ngIf"],["style","width: 100%; height: 350px;",4,"ngIf"],[3,"ngSubmit",4,"ngIf"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],["slot","start","name","albums-outline"],[1,"ion-text-wrap"],[2,"width","100%","height","350px"],[1,"container"],["class","img-center","src","https://res.cloudinary.com/devgea-s-a/image/upload/v1594950613/Finca%20Cienaguilla/mkdr6jfwkclzdzubuuwb.png",4,"ngIf"],["class","img-center",3,"src",4,"ngIf"],["src","https://res.cloudinary.com/devgea-s-a/image/upload/v1594950613/Finca%20Cienaguilla/mkdr6jfwkclzdzubuuwb.png",1,"img-center"],[1,"img-center",3,"src"],[3,"ngSubmit"],["position","floating"],["name","person-outline"],["type","text","rows","6","cols","20","name","descripcion","required","true","maxlength","255",3,"ngModel","ngModelChange"],["type","number","name","precio","required","true","maxlength","10",3,"ngModel","ngModelChange"],["type","number","name","costo","required","true","maxlength","10",3,"ngModel","ngModelChange"],["type","number","name","cantidad","required","true","maxlength","10",3,"ngModel","ngModelChange"],["color","primary","expand","block","type","button",3,"click"],["name","images-outline","slot","start"],["color","primary","expand","block","type","submit",3,"disabled"],["name","save-outline","slot","start"]],template:function(e,t){1&e&&(s.Mb(0,"ion-header",0),s.Mb(1,"ion-toolbar"),s.Mb(2,"ion-title"),s.ic(3,"Presentaci\xf3n"),s.Lb(),s.Mb(4,"ion-buttons",1),s.Mb(5,"ion-button",2),s.Ub("click",(function(){return t.closeModal()})),s.Kb(6,"ion-icon",3),s.Lb(),s.Lb(),s.Lb(),s.Lb(),s.Mb(7,"ion-content"),s.Mb(8,"ion-header",4),s.Mb(9,"ion-toolbar"),s.Mb(10,"ion-title",5),s.ic(11,"Presentaci\xf3n"),s.Lb(),s.Lb(),s.Mb(12,"ion-toolbar"),s.Mb(13,"ion-searchbar",6),s.Ub("ngModelChange",(function(e){return t.search=e})),s.Lb(),s.Lb(),s.Lb(),s.hc(14,p,3,4,"ion-list",7),s.hc(15,v,4,2,"div",8),s.hc(16,M,27,5,"form",9),s.Lb()),2&e&&(s.zb(13),s.bc("ngModel",t.search),s.zb(1),s.bc("ngIf",t.presentaciones),s.zb(1),s.bc("ngIf",t.formulario),s.zb(1),s.bc("ngIf",t.formulario))},directives:[a.t,a.Q,a.P,a.h,a.g,a.u,a.o,a.D,a.ab,o.e,o.h,i.i,a.z,i.h,a.w,a.y,o.j,o.f,o.g,a.O,o.i,o.b,a.v,a.X],pipes:[h.a],styles:["ion-content[_ngcontent-%COMP%]{--padding-start:15px;--padding-end:15px}"]}),L),C=n("tk/3"),I=n("z6cu"),z=n("JIr8"),S=n("BK6h"),x=((y=function(){function e(t){_classCallCheck(this,e),this.http=t,this.basePath=S.a.path,this.httpOptions={headers:new C.c({"Content-Type":"application/json"})}}return _createClass(e,[{key:"handleError",value:function(e){return e.error instanceof ErrorEvent?console.error("Un error ha ocurrido:",e.error.message):console.error("Backend returned code ".concat(e.status,", body was: "),e.error),Object(I.a)(e)}},{key:"getAll",value:function(){return this.http.get(this.basePath+"productos",this.httpOptions).pipe(Object(z.a)(this.handleError))}},{key:"getAllByCategoria",value:function(e){var t;return t=e?"".concat(this.basePath,"productos/categoria/").concat(e):this.basePath+"productos",this.http.get(t).pipe(Object(z.a)(this.handleError))}},{key:"getSingle",value:function(e){return this.http.get("".concat(this.basePath,"productos/").concat(e)).pipe(Object(z.a)(this.handleError))}},{key:"create",value:function(e){return this.http.post(this.basePath+"productos",e,this.httpOptions).pipe(Object(z.a)(this.handleError))}},{key:"update",value:function(e){return this.http.put("".concat(this.basePath,"productos/").concat(e.id),e,this.httpOptions).pipe(Object(z.a)(this.handleError))}},{key:"delete",value:function(e){return this.http.delete("".concat(this.basePath,"productos/").concat(e),this.httpOptions).pipe(Object(z.a)(this.handleError))}}]),e}()).\u0275fac=function(e){return new(e||y)(s.Qb(C.a))},y.\u0275prov=s.Fb({token:y,factory:y.\u0275fac,providedIn:"root"}),y),P=n("LazK");function A(e,t){1&e&&(s.Mb(0,"ion-title"),s.ic(1,"Producto"),s.Lb())}function T(e,t){1&e&&(s.Mb(0,"ion-title"),s.ic(1,"Detalle"),s.Lb())}function w(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-toolbar"),s.Mb(1,"ion-segment",7),s.Ub("ionChange",(function(e){return s.ec(n),s.Wb(2).segmentChanged(e)})),s.Mb(2,"ion-segment-button",8),s.Mb(3,"ion-label"),s.ic(4,"Formulario"),s.Lb(),s.Lb(),s.Mb(5,"ion-segment-button",9),s.Mb(6,"ion-label"),s.ic(7,"Presentaciones"),s.Lb(),s.Lb(),s.Lb(),s.Lb()}}function F(e,t){if(1&e&&(s.Mb(0,"div"),s.hc(1,w,8,0,"ion-toolbar",1),s.Lb()),2&e){var n=s.Wb();s.zb(1),s.bc("ngIf",n.data.id)}}function O(e,t){1&e&&s.Kb(0,"img",31)}function W(e,t){if(1&e&&s.Kb(0,"img",32),2&e){var n=s.Wb(2);s.cc("src",n.strImage,s.fc)}}function U(e,t){if(1&e&&(s.Mb(0,"ion-select-option",33),s.ic(1),s.Lb()),2&e){var n=t.$implicit;s.bc("value",n.id),s.zb(1),s.jc(n.nombre)}}function J(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-content",10),s.Mb(1,"ion-header",11),s.Mb(2,"ion-toolbar"),s.Mb(3,"ion-title",12),s.ic(4,"Producto"),s.Lb(),s.Lb(),s.Lb(),s.Mb(5,"div",13),s.Mb(6,"div",14),s.hc(7,O,1,0,"img",15),s.hc(8,W,1,1,"img",16),s.Lb(),s.Lb(),s.Mb(9,"form",17),s.Ub("ngSubmit",(function(){return s.ec(n),s.Wb().saveChanges()})),s.Mb(10,"ion-item"),s.Mb(11,"ion-label",18),s.Kb(12,"ion-icon",19),s.ic(13," Nombre: "),s.Lb(),s.Mb(14,"ion-input",20),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().data.nombre=e})),s.Lb(),s.Lb(),s.Mb(15,"ion-item"),s.Mb(16,"ion-label",18),s.Kb(17,"ion-icon",19),s.ic(18," Descripcion: "),s.Lb(),s.Mb(19,"ion-textarea",21),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().data.descripcion=e})),s.Lb(),s.Lb(),s.Mb(20,"ion-item"),s.Mb(21,"ion-label",18),s.Kb(22,"ion-icon",19),s.ic(23," Precio: "),s.Lb(),s.Mb(24,"ion-input",22),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().data.precio=e})),s.Lb(),s.Lb(),s.Mb(25,"ion-item"),s.Mb(26,"ion-label",18),s.Kb(27,"ion-icon",19),s.ic(28," Costo: "),s.Lb(),s.Mb(29,"ion-input",23),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().data.costo=e})),s.Lb(),s.Lb(),s.Mb(30,"ion-item"),s.Mb(31,"ion-label",18),s.Kb(32,"ion-icon",19),s.ic(33," Cantidad: "),s.Lb(),s.Mb(34,"ion-input",24),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().data.cantidad=e})),s.Lb(),s.Lb(),s.Mb(35,"ion-item"),s.Mb(36,"ion-label"),s.ic(37,"Categor\xeda"),s.Lb(),s.Mb(38,"ion-select",25),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb().data.categoria=e})),s.hc(39,U,2,2,"ion-select-option",26),s.Lb(),s.Lb(),s.Mb(40,"ion-button",27),s.Ub("click",(function(){return s.ec(n),s.Wb().libreria()})),s.Kb(41,"ion-icon",28),s.ic(42," Seleccionar Imagen "),s.Lb(),s.Mb(43,"ion-button",29),s.Kb(44,"ion-icon",30),s.ic(45," Guardar Cambios "),s.Lb(),s.Lb(),s.Lb()}if(2&e){var i=s.Wb();s.bc("fullscreen",!0),s.zb(7),s.bc("ngIf",!i.strImage),s.zb(1),s.bc("ngIf",i.strImage),s.zb(6),s.bc("ngModel",i.data.nombre),s.zb(5),s.bc("ngModel",i.data.descripcion),s.zb(5),s.bc("ngModel",i.data.precio),s.zb(5),s.bc("ngModel",i.data.costo),s.zb(5),s.bc("ngModel",i.data.cantidad),s.zb(4),s.bc("ngModel",i.data.categoria),s.zb(1),s.bc("ngForOf",i.categorias),s.zb(4),s.bc("disabled",i.disabledBtn)}}function K(e,t){1&e&&s.Kb(0,"img",43)}function j(e,t){if(1&e&&s.Kb(0,"img",44),2&e){var n=s.Wb(2);s.cc("src",n.strImage,s.fc)}}function E(e,t){if(1&e&&(s.Mb(0,"h6",39),s.Mb(1,"strong"),s.ic(2,"Precio: "),s.Lb(),s.ic(3),s.Lb()),2&e){var n=s.Wb(2);s.zb(3),s.kc("Q ",n.data.precio," ")}}function D(e,t){if(1&e&&(s.Mb(0,"h6",39),s.Mb(1,"strong"),s.ic(2,"Cantidad: "),s.Lb(),s.ic(3),s.Lb()),2&e){var n=s.Wb(2);s.zb(3),s.kc("",n.data.cantidad," ")}}function R(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-item",45),s.Ub("click",(function(){s.ec(n);var e=t.$implicit;return s.Wb(2).getDetalle(e)})),s.Kb(1,"ion-icon",46),s.Mb(2,"ion-label",47),s.Mb(3,"h3"),s.Mb(4,"strong"),s.ic(5,"Presentaci\xf3n: "),s.Lb(),s.ic(6),s.Lb(),s.Mb(7,"h3"),s.Mb(8,"strong"),s.ic(9,"Precio: "),s.Lb(),s.ic(10),s.Lb(),s.Mb(11,"h3"),s.Mb(12,"strong"),s.ic(13,"Cantidad: "),s.Lb(),s.ic(14),s.Lb(),s.Lb(),s.Lb()}if(2&e){var i=t.$implicit;s.zb(6),s.jc(i.presentacionNombre),s.zb(4),s.kc("Q ",i.precio,""),s.zb(4),s.jc(i.cantidad)}}function N(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-fab",48),s.Mb(1,"ion-fab-button",3),s.Ub("click",(function(){return s.ec(n),s.Wb(2).presentModal()})),s.Kb(2,"ion-icon",49),s.Lb(),s.Lb()}}function _(e,t){if(1&e&&(s.Mb(0,"ion-content",34),s.Mb(1,"ion-header",11),s.Mb(2,"ion-toolbar"),s.Mb(3,"ion-title",12),s.ic(4,"Detalle"),s.Lb(),s.Lb(),s.Lb(),s.hc(5,K,1,0,"img",35),s.hc(6,j,1,1,"img",36),s.Mb(7,"div",37),s.Mb(8,"ion-text",38),s.Mb(9,"h3",39),s.ic(10),s.Lb(),s.Mb(11,"p",39),s.ic(12),s.Lb(),s.hc(13,E,4,1,"h6",40),s.hc(14,D,4,1,"h6",40),s.Lb(),s.Lb(),s.Mb(15,"ion-list"),s.hc(16,R,15,3,"ion-item",41),s.Xb(17,"filter"),s.Lb(),s.hc(18,N,3,0,"ion-fab",42),s.Lb()),2&e){var n=s.Wb();s.bc("fullscreen",!0),s.zb(5),s.bc("ngIf",!n.strImage),s.zb(1),s.bc("ngIf",n.strImage),s.zb(4),s.jc(n.data.nombre),s.zb(2),s.kc(" ",n.data.descripcion," "),s.zb(1),s.bc("ngIf",0==n.presentaciones.length),s.zb(1),s.bc("ngIf",0==n.presentaciones.length),s.zb(2),s.bc("ngForOf",s.Yb(17,9,n.presentaciones,n.search)),s.zb(2),s.bc("ngIf","Administrador"==n.administratorApp)}}var q,B=((q=function(){function e(t,n,i,o,a,r,c,s,l,b){_classCallCheck(this,e),this.modalController=t,this.camera=n,this.notificacionService=i,this.productoService=o,this.presentacionService=a,this.categoriaService=r,this.uploadFileService=c,this.navParams=s,this.actionSheetController=l,this.alertController=b,this.disabledBtn=!1,this.selectItem="form",this.presentaciones=[],this.data={id:"",nombre:"",descripcion:"",precio:"",costo:"",cantidad:"",imagen:"",categoria:null}}return _createClass(e,[{key:"ngOnInit",value:function(){this.data.id=this.navParams.get("value"),this.categoria=this.navParams.get("categoria"),this.administratorApp=localStorage.getItem("currentType"),"Administrador"!=this.administratorApp&&(this.selectItem="presentacion"),this.data.id&&this.getSingle(+this.data.id),this.getAll()}},{key:"segmentChanged",value:function(e){console.log("Segment changed",e),this.selectItem=e.detail.value}},{key:"closeModal",value:function(e){this.modalController.dismiss(e)}},{key:"getSingle",value:function(e){var t=this;this.productoService.getSingle(e).subscribe((function(e){console.log(e),t.data=e,t.strImage=e.imagen,0==t.categoria&&(t.categoria=e.categoria),t.getAllPresentacion(e.id)}),(function(e){}))}},{key:"getAllPresentacion",value:function(e){var t=this;this.presentacionService.getAllByProducto(e).subscribe((function(e){t.presentaciones=[],t.presentaciones=e}),(function(e){t.presentaciones=[]}))}},{key:"getAll",value:function(){var e=this;this.categoriaService.getAllCategorias().subscribe((function(t){e.categorias=[],e.categorias=t,e.data.categoria=e.categoria}),(function(e){}))}},{key:"saveChanges",value:function(){this.validarCampos()&&(this.disabledBtn=!0,this.data.id?this.update():this.create())}},{key:"validarCampos",value:function(){if(this.data.nombre){if(this.data.descripcion)return!0;this.notificacionService.presentToast("La descripci\xf3n es requerida.")}else this.notificacionService.presentToast("El nombre es requerido.");return!1}},{key:"create",value:function(){var e=this;this.strImage&&(this.data.imagen=this.strImage),this.productoService.create(this.data).subscribe((function(t){e.closeModal(t),e.notificacionService.presentAlert("Producto Agregado","El producto se ha registrado exitosamente.")}),(function(t){e.notificacionService.presentToast("Lo sentimos, ha ocurrido un error intenta m\xe1s tarde.")}))}},{key:"update",value:function(){var e=this;this.strImage&&(this.data.imagen=this.strImage),this.productoService.update(this.data).subscribe((function(t){e.closeModal(t),e.notificacionService.presentAlert("Producto Actualizado","El producto se ha actualizado exitosamente.")}),(function(t){e.notificacionService.presentToast("Lo sentimos, ha ocurrido un error intenta m\xe1s tarde.")}))}},{key:"getDetalle",value:function(e){"Administrador"==this.administratorApp&&this.presentActionSheet(e)}},{key:"presentActionSheet",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.actionSheetController.create({header:"Presentaciones",cssClass:"my-custom-class",buttons:[{text:"Actualizar",icon:"create-outline",handler:function(){i.presentModal(e.id)}},{text:"Eliminar",role:"destructive",icon:"trash-outline",handler:function(){i.presentAlert(e.id)}},{text:"Cancelar",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"presentAlert",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"Eliminar",message:"\xbfDeseas eliminar la presentaci\xf3n?",cssClass:"my-custom-class",buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary",handler:function(e){}},{text:"Aceptar",handler:function(){i.delete(e)}}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"delete",value:function(e){var t=this;this.presentacionService.deleteProductoPresentacion(e).subscribe((function(e){t.notificacionService.presentAlert("Presentaci\xf3n Eliminada","La presentaci\xf3n fue eliminada exitosamente."),t.getAllPresentacion(+t.data.id)}),(function(e){console}))}},{key:"libreria",value:function(){this.procesarImagen({quality:60,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,correctOrientation:!0,sourceType:this.camera.PictureSourceType.PHOTOLIBRARY})}},{key:"procesarImagen",value:function(e){var t=this;this.camera.getPicture(e).then((function(e){t.strImage="https://i.pinimg.com/originals/8e/e2/12/8ee212dac057d412972e0c8cc164deee.gif",t.uploadFileService.subirImagen(e,"Ecommerce/Producto").then((function(e){t.strImage=e.secure_url})).catch((function(e){t.notificacionService.presentToast("Lo sentimos, ha ocurrido un error intenta m\xe1s tarde.")}))}),(function(e){t.notificacionService.presentToast("Lo sentimos, servicio inhabilitado para tu dispositivo.")}))}},{key:"presentModal",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:k,componentProps:{value:e,producto:this.data.id}});case 2:return(n=t.sent).onDidDismiss().then((function(e){e.data&&i.getAllPresentacion(+i.data.id)})),t.next=6,n.present();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})))}}]),e}()).\u0275fac=function(e){return new(e||q)(s.Jb(a.U),s.Jb(d.a),s.Jb(l.a),s.Jb(x),s.Jb(b.a),s.Jb(P.a),s.Jb(u.a),s.Jb(a.W),s.Jb(a.a),s.Jb(a.b))},q.\u0275cmp=s.Db({type:q,selectors:[["app-modal-producto"]],decls:10,vars:5,consts:[["translucent","true"],[4,"ngIf"],["slot","end"],[3,"click"],["slot","icon-only","name","close-circle-outline"],["style","--padding-start: 15px; --padding-end: 15px;",3,"fullscreen",4,"ngIf"],[3,"fullscreen",4,"ngIf"],["value","form",3,"ionChange"],["value","form"],["value","presentacion"],[2,"--padding-start","15px","--padding-end","15px",3,"fullscreen"],["collapse","condense"],["size","large"],[2,"width","100%","height","350px"],[1,"container"],["class","img-center","src","https://res.cloudinary.com/devgea-s-a/image/upload/v1594950613/Finca%20Cienaguilla/mkdr6jfwkclzdzubuuwb.png",4,"ngIf"],["class","img-center",3,"src",4,"ngIf"],[3,"ngSubmit"],["position","floating"],["name","person-outline"],["type","text","name","nombre","required","true","maxlength","255",3,"ngModel","ngModelChange"],["type","text","rows","6","cols","20","name","descripcion","required","true","maxlength","255",3,"ngModel","ngModelChange"],["type","number","name","precio","required","true","maxlength","10",3,"ngModel","ngModelChange"],["type","number","name","costo","required","true","maxlength","10",3,"ngModel","ngModelChange"],["type","number","name","cantidad","required","true","maxlength","10",3,"ngModel","ngModelChange"],["placeholder","Selecciona una categor\xeda","name","categoria",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["color","primary","expand","block","type","button",3,"click"],["name","images-outline","slot","start"],["color","primary","expand","block","type","submit",3,"disabled"],["name","save-outline","slot","start"],["src","https://res.cloudinary.com/devgea-s-a/image/upload/v1594950613/Finca%20Cienaguilla/mkdr6jfwkclzdzubuuwb.png",1,"img-center"],[1,"img-center",3,"src"],[3,"value"],[3,"fullscreen"],["src","https://res.cloudinary.com/devgea-s-a/image/upload/v1594950613/Finca%20Cienaguilla/mkdr6jfwkclzdzubuuwb.png",4,"ngIf"],[3,"src",4,"ngIf"],[2,"text-align","center"],[2,"padding-left","15px","padding-right","15px"],[2,"margin","3px"],["style","margin: 3px;",4,"ngIf"],["button","",3,"click",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["src","https://res.cloudinary.com/devgea-s-a/image/upload/v1594950613/Finca%20Cienaguilla/mkdr6jfwkclzdzubuuwb.png"],[3,"src"],["button","",3,"click"],["slot","start","name","albums-outline"],[1,"ion-text-wrap"],["vertical","bottom","horizontal","end","slot","fixed"],["name","add-outline"]],template:function(e,t){1&e&&(s.Mb(0,"ion-header",0),s.Mb(1,"ion-toolbar"),s.hc(2,A,2,0,"ion-title",1),s.hc(3,T,2,0,"ion-title",1),s.Mb(4,"ion-buttons",2),s.Mb(5,"ion-button",3),s.Ub("click",(function(){return t.closeModal("123")})),s.Kb(6,"ion-icon",4),s.Lb(),s.Lb(),s.Lb(),s.hc(7,F,2,1,"div",1),s.Lb(),s.hc(8,J,46,11,"ion-content",5),s.hc(9,_,19,12,"ion-content",6)),2&e&&(s.zb(2),s.bc("ngIf","form"==t.selectItem),s.zb(1),s.bc("ngIf","presentacion"==t.selectItem),s.zb(4),s.bc("ngIf","Administrador"==t.administratorApp),s.zb(1),s.bc("ngIf","form"==t.selectItem),s.zb(1),s.bc("ngIf","presentacion"==t.selectItem))},directives:[a.t,a.Q,i.i,a.h,a.g,a.u,a.P,a.E,a.Z,a.F,a.y,a.o,o.j,o.f,o.g,a.w,a.v,a.ab,o.i,o.b,o.e,o.h,a.O,a.X,a.G,i.h,a.H,a.N,a.z,a.q,a.r],pipes:[h.a],styles:[""]}),q),$=n("riPR");function G(e,t){1&e&&(s.Mb(0,"ion-buttons",12),s.Kb(1,"ion-back-button",13),s.Lb())}function X(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-button",4),s.Ub("click",(function(){return s.ec(n),s.Wb().goToRoute("presentacion")})),s.Kb(1,"ion-icon",14),s.Lb()}}function H(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-button",4),s.Ub("click",(function(){return s.ec(n),s.Wb().goToRoute("presentacion")})),s.Kb(1,"ion-icon",14),s.Lb()}}function Y(e,t){if(1&e&&(s.Mb(0,"ion-select-option",23),s.ic(1),s.Lb()),2&e){var n=t.$implicit;s.bc("value",n),s.zb(1),s.jc(n.presentacion.nombre)}}function Q(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-item"),s.Mb(1,"ion-label"),s.ic(2,"Presentaci\xf3n"),s.Lb(),s.Mb(3,"ion-select",21),s.Ub("ngModelChange",(function(e){return s.ec(n),s.Wb(2).selectItem=e})),s.hc(4,Y,2,2,"ion-select-option",22),s.Lb(),s.Lb()}if(2&e){var i=s.Wb().$implicit,o=s.Wb();s.zb(3),s.bc("ngModel",o.selectItem),s.zb(1),s.bc("ngForOf",i.presentaciones)}}function Z(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-button",19),s.Ub("click",(function(){s.ec(n);var e=s.Wb().$implicit;return s.Wb().addToCart2(e)})),s.Kb(1,"ion-icon",24),s.ic(2," A\xf1adir al carrito "),s.Lb()}}function V(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-button",19),s.Ub("click",(function(){s.ec(n);var e=s.Wb().$implicit;return s.Wb().addToCart(e)})),s.Kb(1,"ion-icon",24),s.ic(2," A\xf1adir al carrito "),s.Lb()}}function ee(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-button",19),s.Ub("click",(function(){s.ec(n);var e=s.Wb().$implicit;return s.Wb().getDetalle(e)})),s.Kb(1,"ion-icon",25),s.ic(2," Configuraci\xf3n "),s.Lb()}}function te(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-card"),s.Mb(1,"ion-card-header"),s.Mb(2,"ion-card-title",15),s.ic(3),s.Lb(),s.Mb(4,"ion-card-subtitle"),s.ic(5),s.Lb(),s.Lb(),s.Mb(6,"ion-list",16),s.hc(7,Q,5,2,"ion-item",17),s.hc(8,Z,3,0,"ion-button",18),s.hc(9,V,3,0,"ion-button",18),s.Mb(10,"ion-button",19),s.Ub("click",(function(){s.ec(n);var e=t.$implicit;return s.Wb().presentModal(e.id)})),s.Kb(11,"ion-icon",20),s.ic(12," Ver precios "),s.Lb(),s.hc(13,ee,3,0,"ion-button",18),s.Lb(),s.Lb()}if(2&e){var i=t.$implicit,o=s.Wb();s.zb(3),s.jc(i.nombre),s.zb(2),s.jc(i.descripcion),s.zb(2),s.bc("ngIf",0!=i.presentaciones.length),s.zb(1),s.bc("ngIf",0!=i.presentaciones.length),s.zb(1),s.bc("ngIf",0==i.presentaciones.length),s.zb(4),s.bc("ngIf","Administrador"==o.administratorApp)}}function ne(e,t){if(1&e){var n=s.Nb();s.Mb(0,"ion-fab",26),s.Mb(1,"ion-fab-button",4),s.Ub("click",(function(){return s.ec(n),s.Wb().presentModal()})),s.Kb(2,"ion-icon",27),s.Lb(),s.Lb()}}var ie,oe,ae,re=[{path:"",component:(ie=function(){function e(t,n,i,o,a,r,c,s,l,b){var u=this;_classCallCheck(this,e),this.loadingController=t,this.notificacionService=n,this.categoriaService=i,this.alertController=o,this.router=a,this.modalController=r,this.actionSheetController=c,this.activatedRoute=s,this.location=l,this.events=b,this.getAll=function(){u.notificacionService.presentLoading("Cargando..."),u.categoriaService.getAllByCategoria(u.parameter).subscribe((function(e){console.log(e),u.data=[],u.data=e,u.notificacionService.dismissLoading()}),(function(e){u.data=[],u.notificacionService.dismissLoading()}))}}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ionViewDidEnter",value:function(){this.administratorApp=localStorage.getItem("currentType"),this.parameter=+this.activatedRoute.snapshot.paramMap.get("id"),this.getAll()}},{key:"goToRoute",value:function(e){this.router.navigate([""+e])}},{key:"goToBack",value:function(){this.events.publish("categoria:get",{user:"Refresh"}),this.location.back()}},{key:"getDetalle",value:function(e){this.presentActionSheet(e)}},{key:"presentActionSheet",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.actionSheetController.create({header:"Productos",cssClass:"my-custom-class",buttons:[{text:"Actualizar",icon:"create-outline",handler:function(){i.presentModal(e.id)}},{text:"Eliminar",role:"destructive",icon:"trash-outline",handler:function(){i.presentAlert(e.id)}},{text:"Cancel",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"presentModal",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:B,componentProps:{value:e,categoria:this.parameter}});case 2:return(n=t.sent).onDidDismiss().then((function(e){e.data&&i.getAll()})),t.next=6,n.present();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"presentAlert",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"Eliminar",message:"\xbfDeseas eliminar el producto?",cssClass:"my-custom-class",buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary",handler:function(e){}},{text:"Aceptar",handler:function(){i.delete(e)}}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"delete",value:function(e){var t=this;this.categoriaService.delete(e).subscribe((function(e){t.notificacionService.presentAlert("Producto Eliminado","El producto fue eliminado exitosamente."),t.getAll()}),(function(e){console}))}},{key:"addToCart",value:function(e){if(console.log(e),e.cantidad>0){var t={cantidad:1,cantidadTotal:e.cantidad,subtotal:e.precio,precio:e.precio,nombre:e.nombre,producto:e.id,descripcion:null,presentacionProducto:null},n=[];(n=JSON.parse(localStorage.getItem("cart"))).push(t),localStorage.removeItem("cart"),localStorage.setItem("cart",JSON.stringify(n)),this.notificacionService.presentToast(t.nombre+" agregado al carrito :D")}else this.notificacionService.presentToast("Ya no hay existencias.")}},{key:"addToCart2",value:function(e){if(console.log(this.selectItem),this.selectItem)if(this.selectItem.cantidad>0){var t={cantidad:1,cantidadTotal:this.selectItem.cantidad,subtotal:this.selectItem.precio,precio:this.selectItem.precio,nombre:e.nombre,descripcion:this.selectItem.presentacion.nombre,producto:e.id,presentacionProducto:this.selectItem.presentacion.id},n=[];(n=JSON.parse(localStorage.getItem("cart"))).push(t),localStorage.removeItem("cart"),localStorage.setItem("cart",JSON.stringify(n)),this.notificacionService.presentToast(t.nombre+" agregado al carrito :D")}else this.notificacionService.presentToast("Ya no hay existencias.");else this.notificacionService.presentToast("Debe de seleccionar una presentaci\xf3n.");this.selectItem=null}}]),e}(),ie.\u0275fac=function(e){return new(e||ie)(s.Jb(a.T),s.Jb(l.a),s.Jb(x),s.Jb(a.b),s.Jb(r.g),s.Jb(a.U),s.Jb(a.a),s.Jb(r.a),s.Jb(i.f),s.Jb($.a))},ie.\u0275cmp=s.Db({type:ie,selectors:[["app-producto"]],decls:23,vars:9,consts:[["translucent","true"],["slot","start",4,"ngIf"],["collapse","true","slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","cart-outline"],["collapse","condense"],["size","large"],["slot","end"],[3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["slot","start"],["defaultHref","/cliente/categoria"],["slot","icon-only","name","albums-outline"],[2,"font-size","18px"],["lines","none"],[4,"ngIf"],["expand","block","fill","clear",3,"click",4,"ngIf"],["expand","block","fill","clear",3,"click"],["name","information-circle-outline","slot","start"],["name","selectItem","placeholder","Seleccionar",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","cart-outline","slot","start"],["name","settings-outline","slot","start"],["vertical","bottom","horizontal","end","slot","fixed"],["name","add-outline"]],template:function(e,t){1&e&&(s.Mb(0,"ion-header",0),s.Mb(1,"ion-toolbar"),s.hc(2,G,2,0,"ion-buttons",1),s.Mb(3,"ion-title"),s.ic(4,"Productos"),s.Lb(),s.Mb(5,"ion-buttons",2),s.hc(6,X,2,0,"ion-button",3),s.Mb(7,"ion-button",4),s.Ub("click",(function(){return t.goToRoute("carrito")})),s.Kb(8,"ion-icon",5),s.Lb(),s.Lb(),s.Lb(),s.Lb(),s.Mb(9,"ion-content"),s.Mb(10,"ion-header",6),s.Mb(11,"ion-toolbar"),s.Mb(12,"ion-title",7),s.ic(13,"Productos"),s.Lb(),s.Mb(14,"ion-buttons",8),s.hc(15,H,2,0,"ion-button",3),s.Mb(16,"ion-button",4),s.Ub("click",(function(){return t.goToRoute("carrito")})),s.Kb(17,"ion-icon",5),s.Lb(),s.Lb(),s.Lb(),s.Mb(18,"ion-toolbar"),s.Mb(19,"ion-searchbar",9),s.Ub("ngModelChange",(function(e){return t.search=e})),s.Lb(),s.Lb(),s.Lb(),s.hc(20,te,14,6,"ion-card",10),s.Xb(21,"filter"),s.hc(22,ne,3,0,"ion-fab",11),s.Lb()),2&e&&(s.zb(2),s.bc("ngIf",t.parameter),s.zb(4),s.bc("ngIf","Administrador"==t.administratorApp),s.zb(9),s.bc("ngIf","Administrador"==t.administratorApp),s.zb(4),s.bc("ngModel",t.search),s.zb(1),s.bc("ngForOf",s.Yb(21,6,t.data,t.search)),s.zb(2),s.bc("ngIf","Administrador"==t.administratorApp))},directives:[a.t,a.Q,i.i,a.P,a.h,a.g,a.u,a.o,a.D,a.ab,o.e,o.h,i.h,a.e,a.f,a.i,a.j,a.l,a.k,a.z,a.w,a.y,a.G,a.Z,a.H,a.q,a.r],pipes:[h.a],styles:[".img-noticia[_ngcontent-%COMP%]{border-radius:20px;height:90px;width:90px}"]}),ie)}],ce=((ae=function e(){_classCallCheck(this,e)}).\u0275mod=s.Hb({type:ae}),ae.\u0275inj=s.Gb({factory:function(e){return new(e||ae)},imports:[[r.i.forChild(re)],r.i]}),ae),se=((oe=function e(){_classCallCheck(this,e)}).\u0275mod=s.Hb({type:oe}),oe.\u0275inj=s.Gb({factory:function(e){return new(e||oe)},imports:[[i.b,o.a,a.R,ce,h.b]]}),oe)}}]);