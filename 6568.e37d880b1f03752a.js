"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6568],{7691:(I,M,n)=>{n.d(M,{i7:()=>e,LK:()=>m});var _=n(5083),l=n(467),r=function(s){return s.Prompt="PROMPT",s.Camera="CAMERA",s.Photos="PHOTOS",s}(r||{}),h=function(s){return s.Rear="REAR",s.Front="FRONT",s}(h||{}),m=function(s){return s.Uri="uri",s.Base64="base64",s.DataUrl="dataUrl",s}(m||{});class v extends _.E_{getPhoto(o){var u=this;return(0,l.A)(function*(){return new Promise(function(){var d=(0,l.A)(function*(i,p){if(o.webUseInput||o.source===r.Photos)u.fileInputExperience(o,i,p);else if(o.source===r.Prompt){let f=document.querySelector("pwa-action-sheet");f||(f=document.createElement("pwa-action-sheet"),document.body.appendChild(f)),f.header=o.promptLabelHeader||"Photo",f.cancelable=!1,f.options=[{title:o.promptLabelPhoto||"From Photos"},{title:o.promptLabelPicture||"Take Picture"}],f.addEventListener("onSelection",function(){var P=(0,l.A)(function*(S){0===S.detail?u.fileInputExperience(o,i,p):u.cameraExperience(o,i,p)});return function(S){return P.apply(this,arguments)}}())}else u.cameraExperience(o,i,p)});return function(i,p){return d.apply(this,arguments)}}())})()}pickImages(o){var u=this;return(0,l.A)(function*(){return new Promise(function(){var d=(0,l.A)(function*(i,p){u.multipleFileInputExperience(i,p)});return function(i,p){return d.apply(this,arguments)}}())})()}cameraExperience(o,u,d){var i=this;return(0,l.A)(function*(){if(customElements.get("pwa-camera-modal")){const p=document.createElement("pwa-camera-modal");p.facingMode=o.direction===h.Front?"user":"environment",document.body.appendChild(p);try{yield p.componentOnReady(),p.addEventListener("onPhoto",function(){var f=(0,l.A)(function*(P){const S=P.detail;null===S?d(new _.I9("User cancelled photos app")):S instanceof Error?d(S):u(yield i._getCameraPhoto(S,o)),p.dismiss(),document.body.removeChild(p)});return function(P){return f.apply(this,arguments)}}()),p.present()}catch{i.fileInputExperience(o,u,d)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),i.fileInputExperience(o,u,d)})()}fileInputExperience(o,u,d){let i=document.querySelector("#_capacitor-camera-input");const p=()=>{var f;null===(f=i.parentNode)||void 0===f||f.removeChild(i)};i||(i=document.createElement("input"),i.id="_capacitor-camera-input",i.type="file",i.hidden=!0,document.body.appendChild(i),i.addEventListener("change",f=>{const P=i.files[0];let S="jpeg";if("image/png"===P.type?S="png":"image/gif"===P.type&&(S="gif"),"dataUrl"===o.resultType||"base64"===o.resultType){const A=new FileReader;A.addEventListener("load",()=>{if("dataUrl"===o.resultType)u({dataUrl:A.result,format:S});else if("base64"===o.resultType){const O=A.result.split(",")[1];u({base64String:O,format:S})}p()}),A.readAsDataURL(P)}else u({webPath:URL.createObjectURL(P),format:S}),p()}),i.addEventListener("cancel",f=>{d(new _.I9("User cancelled photos app")),p()})),i.accept="image/*",i.capture=!0,o.source===r.Photos||o.source===r.Prompt?i.removeAttribute("capture"):o.direction===h.Front?i.capture="user":o.direction===h.Rear&&(i.capture="environment"),i.click()}multipleFileInputExperience(o,u){let d=document.querySelector("#_capacitor-camera-input-multiple");const i=()=>{var p;null===(p=d.parentNode)||void 0===p||p.removeChild(d)};d||(d=document.createElement("input"),d.id="_capacitor-camera-input-multiple",d.type="file",d.hidden=!0,d.multiple=!0,document.body.appendChild(d),d.addEventListener("change",p=>{const f=[];for(let P=0;P<d.files.length;P++){const S=d.files[P];let A="jpeg";"image/png"===S.type?A="png":"image/gif"===S.type&&(A="gif"),f.push({webPath:URL.createObjectURL(S),format:A})}o({photos:f}),i()}),d.addEventListener("cancel",p=>{u(new _.I9("User cancelled photos app")),i()})),d.accept="image/*",d.click()}_getCameraPhoto(o,u){return new Promise((d,i)=>{const p=new FileReader,f=o.type.split("/")[1];"uri"===u.resultType?d({webPath:URL.createObjectURL(o),format:f,saved:!1}):(p.readAsDataURL(o),p.onloadend=()=>{const P=p.result;d("dataUrl"===u.resultType?{dataUrl:P,format:f,saved:!1}:{base64String:P.split(",")[1],format:f,saved:!1})},p.onerror=P=>{i(P)})})}checkPermissions(){var o=this;return(0,l.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw o.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw o.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var o=this;return(0,l.A)(function*(){throw o.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var o=this;return(0,l.A)(function*(){throw o.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var o=this;return(0,l.A)(function*(){throw o.unavailable("Not implemented on web.")})()}}new v;const e=(0,_.F3)("Camera",{web:()=>new v})},6568:(I,M,n)=>{n.r(M),n.d(M,{SubcategoriasPageModule:()=>k});var _=n(177),l=n(4341),r=n(5150),h=n(8986),m=n(467),v=n(7691),C=n(5312),e=n(3953),s=n(3656),o=n(6417),u=n(8714),d=n(1343);function i(c,E){1&c&&e.nrm(0,"img",16)}function p(c,E){if(1&c&&e.nrm(0,"img",17),2&c){const y=e.XpG();e.FS9("src",y.strImage,e.B4B)}}function f(c,E){if(1&c){const y=e.RV6();e.j41(0,"div")(1,"ion-button",18),e.bIt("click",function(){e.eBV(y);const a=e.XpG();return e.Njj(a.obtenerFoto())}),e.nrm(2,"ion-icon",19),e.EFF(3," Agregar imagen "),e.k0s()()}}let P=(()=>{var c;class E{constructor(t,a,g,b,R){this.modalController=t,this.categoriaService=a,this.notificacionService=g,this.navParams=b,this.uploadImageService=R,this.categoria={id:0,nombre:"",descripcion:"",img:"",color:"primary",categorias:[]},this.btnDisabled=!1}ngOnInit(){this.navParams.get("categoria")&&(this.categoria=this.navParams.get("categoria"),this.strImage=this.categoria.img)}close(){this.modalController.dismiss()}saveChanges(){0==this.categoria.id||null==this.categoria.id||null==this.categoria.id?this.create():this.update()}create(){this.btnDisabled=!0,this.categoriaService.create(this.categoria).subscribe({next:t=>{this.categoria=t,this.btnDisabled=!1},error:t=>{this.btnDisabled=!1,this.notificacionService.presentToast("Algo sali\xf3 mal. Vuelve a intentar, por favor.")}})}update(){this.btnDisabled=!0,this.categoriaService.update(this.categoria).subscribe({next:t=>{this.modalController.dismiss(t),this.btnDisabled=!1},error:t=>{this.btnDisabled=!1,this.notificacionService.presentToast("Algo sali\xf3 mal. Vuelve a intentar, por favor.")}})}obtenerFoto(){var t=this;return(0,m.A)(function*(){try{const a=yield v.i7.getPhoto({quality:90,width:600,resultType:v.LK.DataUrl});t.strImage=a.dataUrl;const g=new FormData;g.append("file",t.dataURLtoFile(a.dataUrl,t.categoria.nombre)),g.append("upload_preset",C.c.uploadPreset),g.append("cloud_name",C.c.cloudName),g.append("folder","Katachi Store/Subcategoria"),t.btnDisabled=!0,t.uploadImageService.create(g).subscribe(b=>{t.categoria.img=b.secure_url,t.btnDisabled=!1})}catch(a){t.notificacionService.presentAlert("Error",JSON.stringify(a))}})()}dataURLtoFile(t,a){let g=t.split(","),b=g[0].match(/:(.*?);/)[1],R=atob(g[1]),U=R.length,F=new Uint8Array(U);for(;U--;)F[U]=R.charCodeAt(U);return new File([F],a,{type:b})}}return(c=E).\u0275fac=function(t){return new(t||c)(e.rXU(r.W3),e.rXU(o.v),e.rXU(u.c),e.rXU(s.y8),e.rXU(d.A))},c.\u0275cmp=e.VBU({type:c,selectors:[["app-form-subcategoria"]],decls:25,vars:7,consts:[["mode","ios"],["color","primary"],["slot","start",3,"click"],["slot","icon-only","name","close-circle"],[1,"ion-padding"],[1,"ion-text-center"],["class","img-center","src","./../../../../assets/images/logo-color.png",4,"ngIf"],["class","img-center",3,"src",4,"ngIf"],[4,"ngIf"],["lines","none",1,"input-item"],["slot","start","name","person","color","primary"],["placeholder","Nombre","type","text",3,"ngModelChange","ngModel"],["slot","start","name","document-text-outline","color","primary"],["placeholder","Descripci\xf3n",3,"ngModelChange","ngModel","autoGrow"],["expand","block","color","primary",3,"click","disabled"],["name","enter","slot","start"],["src","./../../../../assets/images/logo-color.png",1,"img-center"],[1,"img-center",3,"src"],["size","small","color","primary",3,"click"],["name","image","slot","start"]],template:function(t,a){1&t&&(e.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e.bIt("click",function(){return a.close()}),e.j41(3,"ion-button"),e.nrm(4,"ion-icon",3),e.k0s()(),e.j41(5,"ion-title"),e.EFF(6,"CATEGORIA"),e.k0s()()(),e.j41(7,"ion-content",4)(8,"div",5),e.DNE(9,i,1,0,"img",6)(10,p,1,1,"img",7)(11,f,4,0,"div",8),e.k0s(),e.j41(12,"ion-item",9),e.nrm(13,"ion-icon",10),e.j41(14,"ion-input",11),e.mxI("ngModelChange",function(b){return e.DH7(a.categoria.nombre,b)||(a.categoria.nombre=b),b}),e.k0s()(),e.j41(15,"ion-item",9),e.nrm(16,"ion-icon",12),e.j41(17,"ion-textarea",13),e.mxI("ngModelChange",function(b){return e.DH7(a.categoria.descripcion,b)||(a.categoria.descripcion=b),b}),e.k0s()()(),e.j41(18,"ion-footer")(19,"ion-toolbar")(20,"ion-row")(21,"ion-col")(22,"ion-button",14),e.bIt("click",function(){return a.saveChanges()}),e.nrm(23,"ion-icon",15),e.EFF(24," Guardar cambios "),e.k0s()()()()()),2&t&&(e.R7$(9),e.Y8G("ngIf",!a.strImage),e.R7$(),e.Y8G("ngIf",a.strImage),e.R7$(),e.Y8G("ngIf",0!=a.categoria.id),e.R7$(3),e.R50("ngModel",a.categoria.nombre),e.R7$(3),e.R50("ngModel",a.categoria.descripcion),e.Y8G("autoGrow",!0),e.R7$(5),e.Y8G("disabled",a.btnDisabled))},dependencies:[_.bT,l.BC,l.vS,r.Jm,r.QW,r.hU,r.W9,r.M0,r.eU,r.iq,r.$w,r.uz,r.ln,r.nc,r.BC,r.ai,r.Gw],styles:[".img-center[_ngcontent-%COMP%]{background-size:100%;width:200px;height:200px;border-radius:15px}"]}),E})();var S=n(1626);let A=(()=>{var c;class E{constructor(t){this.http=t,this.httpOptions={headers:new S.Lr({"Content-Type":"application/json"})}}getAllByCategoria(t){return this.http.get(`${C.c.urlBackend}/producto_categoria/subcategorias/${t}`,this.httpOptions)}getSingle(t){return this.http.get(`${C.c.urlBackend}/producto_categoria/${t}`,this.httpOptions)}create(t){return this.http.post(`${C.c.urlBackend}/producto_categoria`,t,this.httpOptions)}update(t){return this.http.put(`${C.c.urlBackend}/producto_categoria/${t.id}`,t,this.httpOptions)}delete(t){return this.http.delete(`${C.c.urlBackend}/producto_categoria/${t}`,this.httpOptions)}}return(c=E).\u0275fac=function(t){return new(t||c)(e.KVO(S.Qq))},c.\u0275prov=e.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),E})();var O=n(1551);function D(c,E){if(1&c){const y=e.RV6();e.j41(0,"ion-item-sliding")(1,"ion-item")(2,"div",11),e.nrm(3,"img",12),e.k0s(),e.j41(4,"ion-label")(5,"h3"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s()()(),e.j41(9,"ion-item-options")(10,"ion-item-option",3),e.bIt("click",function(){const a=e.eBV(y).$implicit,g=e.XpG();return e.Njj(g.openModalUpdate(a))}),e.nrm(11,"ion-icon",13),e.EFF(12," Actualizar "),e.k0s(),e.j41(13,"ion-item-option",14),e.bIt("click",function(){const a=e.eBV(y).$implicit,g=e.XpG();return e.Njj(g.deleteCategoria(a.id))}),e.nrm(14,"ion-icon",15),e.EFF(15," Eliminar "),e.k0s()()()}if(2&c){const y=E.$implicit;e.R7$(3),e.Y8G("src",y.img,e.B4B),e.R7$(3),e.JRh(y.nombre),e.R7$(2),e.JRh(y.descripcion)}}const B=[{path:"",component:(()=>{var c;class E{constructor(t,a,g,b,R,U,F){this.subcategoriaService=t,this.modalController=a,this.router=g,this.activatedRoute=b,this.navController=R,this.notificacionService=U,this.alertController=F,this.categorias=[],this.strBuscar=""}ngOnInit(){this.getAllByCategoria(+this.activatedRoute.snapshot.paramMap.get("id"))}getAllByCategoria(t){this.subcategoriaService.getAllByCategoria(t).subscribe({next:a=>{this.categorias=a}})}openModal(){var t=this;return(0,m.A)(function*(){const a=yield t.modalController.create({component:P,componentProps:{categoria:{categoriaId:+t.activatedRoute.snapshot.paramMap.get("id"),id:0}}});yield a.present();const{data:g}=yield a.onDidDismiss();g&&t.getAllByCategoria(+t.activatedRoute.snapshot.paramMap.get("id"))})()}openModalUpdate(t){var a=this;return(0,m.A)(function*(){const g=yield a.modalController.create({component:P,componentProps:{categoria:t}});yield g.present();const{data:b}=yield g.onDidDismiss();b&&a.getAllByCategoria(+a.activatedRoute.snapshot.paramMap.get("id"))})()}onBack(){this.navController.back()}deleteCategoria(t){var a=this;return(0,m.A)(function*(){yield(yield a.alertController.create({header:"Eliminar",message:"\xbfEst\xe1s seguro de que deseas eliminar la subcategor\xeda?",cssClass:"my-custom-class",buttons:[{text:"Cancelar",role:"cancel",handler:b=>{}},{text:"Aceptar",handler:()=>{a.delete(t)}}]})).present()})()}delete(t){this.subcategoriaService.delete(t).subscribe({next:a=>{this.notificacionService.presentAlert("Subcategor\xeda eliminada","La subcategor\xeda ha sido eliminada con \xe9xito."),this.getAllByCategoria(+this.activatedRoute.snapshot.paramMap.get("id"))},error:a=>{this.notificacionService.presentToast("Algo sali\xf3 mal. Vuelve a intentar, por favor.")}})}handleRefresh(t){setTimeout(()=>{this.getAllByCategoria(+this.activatedRoute.snapshot.paramMap.get("id")),t.target.complete()},2e3)}}return(c=E).\u0275fac=function(t){return new(t||c)(e.rXU(A),e.rXU(r.W3),e.rXU(h.Ix),e.rXU(h.nX),e.rXU(s.q9),e.rXU(u.c),e.rXU(r.hG))},c.\u0275cmp=e.VBU({type:c,selectors:[["app-subcategorias"]],decls:18,vars:6,consts:[["mode","ios"],["color","primary"],["slot","start"],[3,"click"],["slot","icon-only","name","chevron-back-circle"],["placeholder","Buscar",3,"ngModelChange","ngModel"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[4,"ngFor","ngForOf"],["slot","fixed","vertical","bottom","horizontal","end"],["name","add"],[1,"glass"],[3,"src"],["slot","bottom","name","create-outline"],["color","danger",3,"click"],["slot","bottom","name","trash-outline"]],template:function(t,a){1&t&&(e.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),e.bIt("click",function(){return a.onBack()}),e.nrm(4,"ion-icon",4),e.k0s()(),e.j41(5,"ion-title"),e.EFF(6,"SUBCATEGORIAS"),e.k0s()(),e.j41(7,"ion-toolbar",1)(8,"ion-searchbar",5),e.mxI("ngModelChange",function(b){return e.DH7(a.strBuscar,b)||(a.strBuscar=b),b}),e.k0s()()(),e.j41(9,"ion-content",6)(10,"ion-refresher",7),e.bIt("ionRefresh",function(b){return a.handleRefresh(b)}),e.nrm(11,"ion-refresher-content"),e.k0s(),e.j41(12,"ion-list"),e.DNE(13,D,16,3,"ion-item-sliding",8),e.nI1(14,"filter"),e.k0s(),e.j41(15,"ion-fab",9)(16,"ion-fab-button",3),e.bIt("click",function(){return a.openModal()}),e.nrm(17,"ion-icon",10),e.k0s()()()),2&t&&(e.R7$(8),e.R50("ngModel",a.strBuscar),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(4),e.Y8G("ngForOf",e.i5U(14,3,a.categorias,a.strBuscar)))},dependencies:[_.Sq,l.BC,l.vS,r.Jm,r.QW,r.W9,r.Q8,r.YW,r.eU,r.iq,r.uz,r.LU,r.CE,r.A7,r.he,r.nf,r.To,r.Ki,r.S1,r.BC,r.ai,r.Gw,O.E]}),E})()}];let L=(()=>{var c;class E{}return(c=E).\u0275fac=function(t){return new(t||c)},c.\u0275mod=e.$C({type:c}),c.\u0275inj=e.G2t({imports:[h.iI.forChild(B),h.iI]}),E})();var T=n(4582);let k=(()=>{var c;class E{}return(c=E).\u0275fac=function(t){return new(t||c)},c.\u0275mod=e.$C({type:c}),c.\u0275inj=e.G2t({imports:[_.MD,l.YN,r.bv,L,T.L]}),E})()},1551:(I,M,n)=>{n.d(M,{E:()=>l});var _=n(3953);let l=(()=>{var r;class h{transform(v,C,e=[]){return C&&v?h.filter(v,C,e):v}static filter(v,C,e){const s=C.toLowerCase();function o(u,d){if("string"==typeof u&&u.toString().toLowerCase().includes(s))return!0;for(let i in u)if(null!==u[i]&&null!=u[i]&&!e.includes(i))if("object"==typeof u[i]){if(o(u[i],d))return!0}else if(u[i].toString().toLowerCase().includes(s))return!0;return!1}return v.filter(function(u){return o(u,C)})}}return(r=h).\u0275fac=function(v){return new(v||r)},r.\u0275pipe=_.EJ8({name:"filter",type:r,pure:!1}),r.\u0275prov=_.jDH({token:r,factory:r.\u0275fac}),h})()},4582:(I,M,n)=>{n.d(M,{L:()=>r});var _=n(177),l=n(3953);let r=(()=>{var h;class m{}return(h=m).\u0275fac=function(C){return new(C||h)},h.\u0275mod=l.$C({type:h}),h.\u0275inj=l.G2t({imports:[_.MD]}),m})()},6417:(I,M,n)=>{n.d(M,{v:()=>h});var _=n(1626),l=n(5312),r=n(3953);let h=(()=>{var m;class v{constructor(e){this.http=e,this.httpOptions={headers:new _.Lr({"Content-Type":"application/json"})}}getAllCategorias(){return this.http.get(`${l.c.urlBackend}/producto_categoria_all`,this.httpOptions)}getAll(){return this.http.get(`${l.c.urlBackend}/producto_categoria/`,this.httpOptions)}getSingle(e){return this.http.get(`${l.c.urlBackend}/producto_categoria/${e}`,this.httpOptions)}create(e){return this.http.post(`${l.c.urlBackend}/producto_categoria`,e,this.httpOptions)}update(e){return this.http.put(`${l.c.urlBackend}/producto_categoria/${e.id}`,e,this.httpOptions)}delete(e){return this.http.delete(`${l.c.urlBackend}/producto_categoria/${e}`,this.httpOptions)}}return(m=v).\u0275fac=function(e){return new(e||m)(r.KVO(_.Qq))},m.\u0275prov=r.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),v})()},8714:(I,M,n)=>{n.d(M,{c:()=>h});var _=n(467),l=n(3953),r=n(5150);let h=(()=>{var m;class v{constructor(e,s,o){this.toastController=e,this.loadingController=s,this.alertController=o,this.isLoading=!1}presentToast(e,s="bottom"){var o=this;return(0,_.A)(function*(){(yield o.toastController.create({message:e,duration:2500,position:s})).present()})()}presentAlert(e,s){var o=this;return(0,_.A)(function*(){yield(yield o.alertController.create({cssClass:"my-custom-class",header:e,message:s,buttons:["OK"]})).present()})()}presentLoading(e){var s=this;return(0,_.A)(function*(){return s.isLoading=!0,yield s.loadingController.create({message:e,duration:1e3}).then(o=>{o.present().then(()=>{s.isLoading||o.dismiss()})})})()}dismissLoading(){var e=this;return(0,_.A)(function*(){return yield e.loadingController.getTop().then(s=>{s&&(e.isLoading=!1,e.loadingController.dismiss())})})()}}return(m=v).\u0275fac=function(e){return new(e||m)(l.KVO(r.K_),l.KVO(r.Xi),l.KVO(r.hG))},m.\u0275prov=l.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),v})()},1343:(I,M,n)=>{n.d(M,{A:()=>h});var _=n(5312),l=n(1626),r=n(3953);let h=(()=>{var m;class v{constructor(e){this.http=e,this.httpOptions={headers:new l.Lr({"Content-Type":"application/json"})}}create(e){return this.http.post(`${_.c.urlCloudinary}`,e)}}return(m=v).\u0275fac=function(e){return new(e||m)(r.KVO(l.Qq))},m.\u0275prov=r.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),v})()}}]);