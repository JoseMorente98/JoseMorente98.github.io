"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3741],{7691:(U,I,a)=>{a.d(I,{i7:()=>e,LK:()=>p});var _=a(5083),l=a(467),t=function(s){return s.Prompt="PROMPT",s.Camera="CAMERA",s.Photos="PHOTOS",s}(t||{}),h=function(s){return s.Rear="REAR",s.Front="FRONT",s}(h||{}),p=function(s){return s.Uri="uri",s.Base64="base64",s.DataUrl="dataUrl",s}(p||{});class v extends _.E_{getPhoto(r){var c=this;return(0,l.A)(function*(){return new Promise(function(){var d=(0,l.A)(function*(o,m){if(r.webUseInput||r.source===t.Photos)c.fileInputExperience(r,o,m);else if(r.source===t.Prompt){let f=document.querySelector("pwa-action-sheet");f||(f=document.createElement("pwa-action-sheet"),document.body.appendChild(f)),f.header=r.promptLabelHeader||"Photo",f.cancelable=!1,f.options=[{title:r.promptLabelPhoto||"From Photos"},{title:r.promptLabelPicture||"Take Picture"}],f.addEventListener("onSelection",function(){var b=(0,l.A)(function*(P){0===P.detail?c.fileInputExperience(r,o,m):c.cameraExperience(r,o,m)});return function(P){return b.apply(this,arguments)}}())}else c.cameraExperience(r,o,m)});return function(o,m){return d.apply(this,arguments)}}())})()}pickImages(r){var c=this;return(0,l.A)(function*(){return new Promise(function(){var d=(0,l.A)(function*(o,m){c.multipleFileInputExperience(o,m)});return function(o,m){return d.apply(this,arguments)}}())})()}cameraExperience(r,c,d){var o=this;return(0,l.A)(function*(){if(customElements.get("pwa-camera-modal")){const m=document.createElement("pwa-camera-modal");m.facingMode=r.direction===h.Front?"user":"environment",document.body.appendChild(m);try{yield m.componentOnReady(),m.addEventListener("onPhoto",function(){var f=(0,l.A)(function*(b){const P=b.detail;null===P?d(new _.I9("User cancelled photos app")):P instanceof Error?d(P):c(yield o._getCameraPhoto(P,r)),m.dismiss(),document.body.removeChild(m)});return function(b){return f.apply(this,arguments)}}()),m.present()}catch{o.fileInputExperience(r,c,d)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),o.fileInputExperience(r,c,d)})()}fileInputExperience(r,c,d){let o=document.querySelector("#_capacitor-camera-input");const m=()=>{var f;null===(f=o.parentNode)||void 0===f||f.removeChild(o)};o||(o=document.createElement("input"),o.id="_capacitor-camera-input",o.type="file",o.hidden=!0,document.body.appendChild(o),o.addEventListener("change",f=>{const b=o.files[0];let P="jpeg";if("image/png"===b.type?P="png":"image/gif"===b.type&&(P="gif"),"dataUrl"===r.resultType||"base64"===r.resultType){const M=new FileReader;M.addEventListener("load",()=>{if("dataUrl"===r.resultType)c({dataUrl:M.result,format:P});else if("base64"===r.resultType){const D=M.result.split(",")[1];c({base64String:D,format:P})}m()}),M.readAsDataURL(b)}else c({webPath:URL.createObjectURL(b),format:P}),m()}),o.addEventListener("cancel",f=>{d(new _.I9("User cancelled photos app")),m()})),o.accept="image/*",o.capture=!0,r.source===t.Photos||r.source===t.Prompt?o.removeAttribute("capture"):r.direction===h.Front?o.capture="user":r.direction===h.Rear&&(o.capture="environment"),o.click()}multipleFileInputExperience(r,c){let d=document.querySelector("#_capacitor-camera-input-multiple");const o=()=>{var m;null===(m=d.parentNode)||void 0===m||m.removeChild(d)};d||(d=document.createElement("input"),d.id="_capacitor-camera-input-multiple",d.type="file",d.hidden=!0,d.multiple=!0,document.body.appendChild(d),d.addEventListener("change",m=>{const f=[];for(let b=0;b<d.files.length;b++){const P=d.files[b];let M="jpeg";"image/png"===P.type?M="png":"image/gif"===P.type&&(M="gif"),f.push({webPath:URL.createObjectURL(P),format:M})}r({photos:f}),o()}),d.addEventListener("cancel",m=>{c(new _.I9("User cancelled photos app")),o()})),d.accept="image/*",d.click()}_getCameraPhoto(r,c){return new Promise((d,o)=>{const m=new FileReader,f=r.type.split("/")[1];"uri"===c.resultType?d({webPath:URL.createObjectURL(r),format:f,saved:!1}):(m.readAsDataURL(r),m.onloadend=()=>{const b=m.result;d("dataUrl"===c.resultType?{dataUrl:b,format:f,saved:!1}:{base64String:b.split(",")[1],format:f,saved:!1})},m.onerror=b=>{o(b)})})}checkPermissions(){var r=this;return(0,l.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw r.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw r.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var r=this;return(0,l.A)(function*(){throw r.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var r=this;return(0,l.A)(function*(){throw r.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var r=this;return(0,l.A)(function*(){throw r.unavailable("Not implemented on web.")})()}}new v;const e=(0,_.F3)("Camera",{web:()=>new v})},3741:(U,I,a)=>{a.r(I),a.d(I,{CategoriasPageModule:()=>j});var _=a(177),l=a(4341),t=a(5150),h=a(8986),p=a(467),v=a(7691),E=a(5312),e=a(3953),s=a(3656),r=a(6417),c=a(8714),d=a(1343);function o(u,A){1&u&&e.nrm(0,"img",16)}function m(u,A){if(1&u&&e.nrm(0,"img",17),2&u){const y=e.XpG();e.FS9("src",y.strImage,e.B4B)}}function f(u,A){if(1&u){const y=e.RV6();e.j41(0,"div")(1,"ion-button",18),e.bIt("click",function(){e.eBV(y);const i=e.XpG();return e.Njj(i.obtenerFoto())}),e.nrm(2,"ion-icon",19),e.EFF(3," Agregar imagen "),e.k0s()()}}let b=(()=>{var u;class A{constructor(n,i,g,C,F){this.modalController=n,this.categoriaService=i,this.notificacionService=g,this.navParams=C,this.uploadImageService=F,this.categoria={id:0,nombre:"",descripcion:"",img:"",color:"primary",categorias:[]},this.btnDisabled=!1}ngOnInit(){this.navParams.get("categoria")&&(this.categoria=this.navParams.get("categoria"),this.strImage=this.categoria.img)}close(){this.modalController.dismiss()}saveChanges(){0==this.categoria.id?this.create():this.update()}create(){this.btnDisabled=!0,this.categoriaService.create(this.categoria).subscribe({next:n=>{this.categoria=n,this.btnDisabled=!1},error:n=>{this.btnDisabled=!1,this.notificacionService.presentToast("Algo sali\xf3 mal. Vuelve a intentar, por favor.")}})}update(){this.btnDisabled=!0,this.categoriaService.update(this.categoria).subscribe({next:n=>{this.modalController.dismiss(n),this.btnDisabled=!1},error:n=>{this.btnDisabled=!1,this.notificacionService.presentToast("Algo sali\xf3 mal. Vuelve a intentar, por favor.")}})}obtenerFoto(){var n=this;return(0,p.A)(function*(){try{const i=yield v.i7.getPhoto({quality:90,width:600,resultType:v.LK.DataUrl});n.strImage=i.dataUrl;const g=new FormData;g.append("file",n.dataURLtoFile(i.dataUrl,n.categoria.nombre)),g.append("upload_preset",E.c.uploadPreset),g.append("cloud_name",E.c.cloudName),g.append("folder","Katachi Store/Categoria"),n.btnDisabled=!0,n.uploadImageService.create(g).subscribe(C=>{n.categoria.img=C.secure_url,n.btnDisabled=!1})}catch(i){n.notificacionService.presentAlert("Error",JSON.stringify(i))}})()}dataURLtoFile(n,i){let g=n.split(","),C=g[0].match(/:(.*?);/)[1],F=atob(g[1]),R=F.length,O=new Uint8Array(R);for(;R--;)O[R]=F.charCodeAt(R);return new File([O],i,{type:C})}}return(u=A).\u0275fac=function(n){return new(n||u)(e.rXU(t.W3),e.rXU(r.v),e.rXU(c.c),e.rXU(s.y8),e.rXU(d.A))},u.\u0275cmp=e.VBU({type:u,selectors:[["app-form-categoria"]],decls:25,vars:7,consts:[["mode","ios"],["color","primary"],["slot","start",3,"click"],["slot","icon-only","name","close-circle"],[1,"ion-padding"],[1,"ion-text-center"],["class","img-center","src","./../../../../assets/images/logo-color.png",4,"ngIf"],["class","img-center",3,"src",4,"ngIf"],[4,"ngIf"],["lines","none",1,"input-item"],["slot","start","name","person","color","primary"],["placeholder","Nombre","type","text",3,"ngModelChange","ngModel"],["slot","start","name","document-text-outline","color","primary"],["placeholder","Descripci\xf3n",3,"ngModelChange","ngModel","autoGrow"],["expand","block","color","primary",3,"click","disabled"],["name","enter","slot","start"],["src","./../../../../assets/images/logo-color.png",1,"img-center"],[1,"img-center",3,"src"],["size","small","color","primary",3,"click"],["name","image","slot","start"]],template:function(n,i){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e.bIt("click",function(){return i.close()}),e.j41(3,"ion-button"),e.nrm(4,"ion-icon",3),e.k0s()(),e.j41(5,"ion-title"),e.EFF(6,"CATEGORIA"),e.k0s()()(),e.j41(7,"ion-content",4)(8,"div",5),e.DNE(9,o,1,0,"img",6)(10,m,1,1,"img",7)(11,f,4,0,"div",8),e.k0s(),e.j41(12,"ion-item",9),e.nrm(13,"ion-icon",10),e.j41(14,"ion-input",11),e.mxI("ngModelChange",function(C){return e.DH7(i.categoria.nombre,C)||(i.categoria.nombre=C),C}),e.k0s()(),e.j41(15,"ion-item",9),e.nrm(16,"ion-icon",12),e.j41(17,"ion-textarea",13),e.mxI("ngModelChange",function(C){return e.DH7(i.categoria.descripcion,C)||(i.categoria.descripcion=C),C}),e.k0s()()(),e.j41(18,"ion-footer")(19,"ion-toolbar")(20,"ion-row")(21,"ion-col")(22,"ion-button",14),e.bIt("click",function(){return i.saveChanges()}),e.nrm(23,"ion-icon",15),e.EFF(24," Guardar cambios "),e.k0s()()()()()),2&n&&(e.R7$(9),e.Y8G("ngIf",!i.strImage),e.R7$(),e.Y8G("ngIf",i.strImage),e.R7$(),e.Y8G("ngIf",0!=i.categoria.id),e.R7$(3),e.R50("ngModel",i.categoria.nombre),e.R7$(3),e.R50("ngModel",i.categoria.descripcion),e.Y8G("autoGrow",!0),e.R7$(5),e.Y8G("disabled",i.btnDisabled))},dependencies:[_.bT,l.BC,l.vS,t.Jm,t.QW,t.hU,t.W9,t.M0,t.eU,t.iq,t.$w,t.uz,t.ln,t.nc,t.BC,t.ai,t.Gw],styles:[".img-center[_ngcontent-%COMP%]{background-size:100%;width:200px;height:200px;border-radius:15px}"]}),A})();var P=a(1551);function M(u,A){if(1&u){const y=e.RV6();e.j41(0,"ion-item-sliding")(1,"ion-item",7),e.bIt("click",function(){const i=e.eBV(y).$implicit,g=e.XpG();return e.Njj(g.goToRoute(i.id))}),e.j41(2,"div",9),e.nrm(3,"img",10),e.k0s(),e.j41(4,"ion-label")(5,"h3"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s()()(),e.j41(9,"ion-item-options")(10,"ion-item-option",7),e.bIt("click",function(){const i=e.eBV(y).$implicit,g=e.XpG();return e.Njj(g.openModalUpdate(i))}),e.nrm(11,"ion-icon",11),e.EFF(12," Actualizar "),e.k0s(),e.j41(13,"ion-item-option",12),e.bIt("click",function(){const i=e.eBV(y).$implicit,g=e.XpG();return e.Njj(g.deleteCategoria(i.id))}),e.nrm(14,"ion-icon",13),e.EFF(15," Eliminar "),e.k0s()()()}if(2&u){const y=A.$implicit;e.R7$(3),e.Y8G("src",y.img,e.B4B),e.R7$(3),e.JRh(y.nombre),e.R7$(2),e.JRh(y.descripcion)}}const T=[{path:"",component:(()=>{var u;class A{constructor(n,i,g,C,F){this.categoriaService=n,this.modalController=i,this.notificacionService=g,this.router=C,this.alertController=F,this.categorias=[],this.strBuscar=""}ngOnInit(){this.getAll()}getAll(){this.categoriaService.getAll().subscribe({next:n=>{this.categorias=n,console.log(this.categorias)}})}openModal(){var n=this;return(0,p.A)(function*(){const i=yield n.modalController.create({component:b});yield i.present();const{data:g}=yield i.onDidDismiss();g&&n.getAll()})()}openModalUpdate(n){var i=this;return(0,p.A)(function*(){const g=yield i.modalController.create({component:b,componentProps:{categoria:n}});yield g.present();const{data:C}=yield g.onDidDismiss();C&&i.getAll()})()}goToRoute(n){this.router.navigate(["admin/subcategorias",n])}deleteCategoria(n){var i=this;return(0,p.A)(function*(){yield(yield i.alertController.create({header:"Eliminar",message:"\xbfEst\xe1s seguro de que deseas eliminar la categor\xeda?",cssClass:"my-custom-class",buttons:[{text:"Cancelar",role:"cancel",handler:C=>{}},{text:"Aceptar",handler:()=>{i.delete(n)}}]})).present()})()}delete(n){this.categoriaService.delete(n).subscribe({next:i=>{this.notificacionService.presentAlert("Categor\xeda eliminada","La categor\xeda ha sido eliminada con \xe9xito."),this.getAll()},error:i=>{console.log(i),this.notificacionService.presentToast("Algo sali\xf3 mal. Vuelve a intentar, por favor.")}})}handleRefresh(n){setTimeout(()=>{this.getAll(),n.target.complete()},2e3)}}return(u=A).\u0275fac=function(n){return new(n||u)(e.rXU(r.v),e.rXU(t.W3),e.rXU(c.c),e.rXU(h.Ix),e.rXU(t.hG))},u.\u0275cmp=e.VBU({type:u,selectors:[["app-categorias"]],decls:15,vars:6,consts:[["mode","ios"],["color","primary"],["placeholder","Buscar",3,"ngModelChange","ngModel"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[4,"ngFor","ngForOf"],["slot","fixed","vertical","bottom","horizontal","end"],[3,"click"],["name","add"],[1,"glass"],[3,"src"],["slot","bottom","name","create-outline"],["color","danger",3,"click"],["slot","bottom","name","trash-outline"]],template:function(n,i){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),e.EFF(3,"CATEGORIAS"),e.k0s()(),e.j41(4,"ion-toolbar",1)(5,"ion-searchbar",2),e.mxI("ngModelChange",function(C){return e.DH7(i.strBuscar,C)||(i.strBuscar=C),C}),e.k0s()()(),e.j41(6,"ion-content",3)(7,"ion-refresher",4),e.bIt("ionRefresh",function(C){return i.handleRefresh(C)}),e.nrm(8,"ion-refresher-content"),e.k0s(),e.j41(9,"ion-list"),e.DNE(10,M,16,3,"ion-item-sliding",5),e.nI1(11,"filter"),e.k0s(),e.j41(12,"ion-fab",6)(13,"ion-fab-button",7),e.bIt("click",function(){return i.openModal()}),e.nrm(14,"ion-icon",8),e.k0s()()()),2&n&&(e.R7$(5),e.R50("ngModel",i.strBuscar),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(4),e.Y8G("ngForOf",e.i5U(11,3,i.categorias,i.strBuscar)))},dependencies:[_.Sq,l.BC,l.vS,t.W9,t.Q8,t.YW,t.eU,t.iq,t.uz,t.LU,t.CE,t.A7,t.he,t.nf,t.To,t.Ki,t.S1,t.BC,t.ai,t.Gw,P.E]}),A})()}];let L=(()=>{var u;class A{}return(u=A).\u0275fac=function(n){return new(n||u)},u.\u0275mod=e.$C({type:u}),u.\u0275inj=e.G2t({imports:[h.iI.forChild(T),h.iI]}),A})();var S=a(4582);let j=(()=>{var u;class A{}return(u=A).\u0275fac=function(n){return new(n||u)},u.\u0275mod=e.$C({type:u}),u.\u0275inj=e.G2t({imports:[_.MD,l.YN,t.bv,L,S.L]}),A})()},1551:(U,I,a)=>{a.d(I,{E:()=>l});var _=a(3953);let l=(()=>{var t;class h{transform(v,E,e=[]){return E&&v?h.filter(v,E,e):v}static filter(v,E,e){const s=E.toLowerCase();function r(c,d){if("string"==typeof c&&c.toString().toLowerCase().includes(s))return!0;for(let o in c)if(null!==c[o]&&null!=c[o]&&!e.includes(o))if("object"==typeof c[o]){if(r(c[o],d))return!0}else if(c[o].toString().toLowerCase().includes(s))return!0;return!1}return v.filter(function(c){return r(c,E)})}}return(t=h).\u0275fac=function(v){return new(v||t)},t.\u0275pipe=_.EJ8({name:"filter",type:t,pure:!1}),t.\u0275prov=_.jDH({token:t,factory:t.\u0275fac}),h})()},4582:(U,I,a)=>{a.d(I,{L:()=>t});var _=a(177),l=a(3953);let t=(()=>{var h;class p{}return(h=p).\u0275fac=function(E){return new(E||h)},h.\u0275mod=l.$C({type:h}),h.\u0275inj=l.G2t({imports:[_.MD]}),p})()},6417:(U,I,a)=>{a.d(I,{v:()=>h});var _=a(1626),l=a(5312),t=a(3953);let h=(()=>{var p;class v{constructor(e){this.http=e,this.httpOptions={headers:new _.Lr({"Content-Type":"application/json"})}}getAllCategorias(){return this.http.get(`${l.c.urlBackend}/producto_categoria_all`,this.httpOptions)}getAll(){return this.http.get(`${l.c.urlBackend}/producto_categoria/`,this.httpOptions)}getSingle(e){return this.http.get(`${l.c.urlBackend}/producto_categoria/${e}`,this.httpOptions)}create(e){return this.http.post(`${l.c.urlBackend}/producto_categoria`,e,this.httpOptions)}update(e){return this.http.put(`${l.c.urlBackend}/producto_categoria/${e.id}`,e,this.httpOptions)}delete(e){return this.http.delete(`${l.c.urlBackend}/producto_categoria/${e}`,this.httpOptions)}}return(p=v).\u0275fac=function(e){return new(e||p)(t.KVO(_.Qq))},p.\u0275prov=t.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),v})()},8714:(U,I,a)=>{a.d(I,{c:()=>h});var _=a(467),l=a(3953),t=a(5150);let h=(()=>{var p;class v{constructor(e,s,r){this.toastController=e,this.loadingController=s,this.alertController=r,this.isLoading=!1}presentToast(e,s="bottom"){var r=this;return(0,_.A)(function*(){(yield r.toastController.create({message:e,duration:2500,position:s})).present()})()}presentAlert(e,s){var r=this;return(0,_.A)(function*(){yield(yield r.alertController.create({cssClass:"my-custom-class",header:e,message:s,buttons:["OK"]})).present()})()}presentLoading(e){var s=this;return(0,_.A)(function*(){return s.isLoading=!0,yield s.loadingController.create({message:e,duration:1e3}).then(r=>{r.present().then(()=>{s.isLoading||r.dismiss()})})})()}dismissLoading(){var e=this;return(0,_.A)(function*(){return yield e.loadingController.getTop().then(s=>{s&&(e.isLoading=!1,e.loadingController.dismiss())})})()}}return(p=v).\u0275fac=function(e){return new(e||p)(l.KVO(t.K_),l.KVO(t.Xi),l.KVO(t.hG))},p.\u0275prov=l.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),v})()},1343:(U,I,a)=>{a.d(I,{A:()=>h});var _=a(5312),l=a(1626),t=a(3953);let h=(()=>{var p;class v{constructor(e){this.http=e,this.httpOptions={headers:new l.Lr({"Content-Type":"application/json"})}}create(e){return this.http.post(`${_.c.urlCloudinary}`,e)}}return(p=v).\u0275fac=function(e){return new(e||p)(t.KVO(l.Qq))},p.\u0275prov=t.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),v})()}}]);