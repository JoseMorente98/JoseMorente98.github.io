(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"4v5Q":function(e,i,t){"use strict";t.r(i),t.d(i,"CompraPageModule",(function(){return y}));var n=t("ofXK"),o=t("3Pt+"),a=t("TEn/"),c=t("tyNb"),r=t("fXoL"),s=t("a/9d"),b=t("J/xi"),l=t("DgPi"),d=t("TgOq"),u=t("ba22");function g(e,i){1&e&&r.Kb(0,"img",30)}function h(e,i){if(1&e&&r.Kb(0,"img",31),2&e){const e=r.Wb();r.cc("src",e.strImage,r.fc)}}function p(e,i){if(1&e&&(r.Mb(0,"ion-select-option",32),r.ic(1),r.Lb()),2&e){const e=i.$implicit;r.bc("value",e.id),r.zb(1),r.jc(e.direccion)}}function m(e,i){if(1&e&&(r.Mb(0,"ion-select-option",32),r.ic(1),r.Lb()),2&e){const e=i.$implicit;r.bc("value",e.id),r.zb(1),r.jc(e.nombre)}}function f(e,i){if(1&e){const e=r.Nb();r.Mb(0,"ion-item"),r.Mb(1,"ion-label",14),r.Kb(2,"ion-icon",33),r.ic(3," No. Boleta: "),r.Lb(),r.Mb(4,"ion-input",34),r.Ub("ngModelChange",(function(i){return r.ec(e),r.Wb().data.boleta=i})),r.Lb(),r.Lb()}if(2&e){const e=r.Wb();r.zb(4),r.bc("ngModel",e.data.boleta)}}function M(e,i){if(1&e){const e=r.Nb();r.Mb(0,"ion-button",35),r.Ub("click",(function(){return r.ec(e),r.Wb().libreria()})),r.Kb(1,"ion-icon",36),r.ic(2," Seleccionar Imagen "),r.Lb()}}const v=[{path:"",component:(()=>{class e{constructor(e,i,t,n,o,a,c){this.camera=e,this.notificacionService=i,this.uploadFileService=t,this.ventaService=n,this.direccionService=o,this.location=a,this.router=c,this.disabledBtn=!1,this.data={nit:"",total:0,boleta:"",boletaImagen:"",observaciones:"",estado:0,tipoOrden:0,direccion:0,fechaEntrega:null,fechaRecibido:null,usuario:2,detalle:[]},this.cart=[],this.direcciones=[],this.tipoDePago=[],this.getAllTipos=()=>{this.ventaService.getAllTipo().subscribe(e=>{console.log(e),this.tipoDePago=[],this.tipoDePago=e},e=>{this.tipoDePago=[]})},this.getAllDirecciones=()=>{this.direccionService.getAll().subscribe(e=>{console.log(e),this.direcciones=[],this.direcciones=e},e=>{this.direcciones=[]})}}ngOnInit(){}ionViewWillEnter(){this.cart=JSON.parse(localStorage.getItem("cart")),this.data.detalle=JSON.parse(localStorage.getItem("cart")),this.obtenerTotal(),this.getAllDirecciones(),this.getAllTipos()}goToBack(){this.location.back()}goToRoute(e){this.router.navigate([""+e])}saveChanges(){this.strImage&&(this.data.boletaImagen=this.strImage),this.data.estado=this.data.tipoOrden,this.validarCampos()&&this.create()}validarCampos(){if(this.data.direccion)if(this.data.tipoOrden){if(2!=this.data.tipoOrden)return!0;if(this.validarDeposito())return!0}else this.notificacionService.presentToast("El tipo de orden es requerido.");else this.notificacionService.presentToast("La direcci\xf3n es requerida.");return!1}validarDeposito(){if(this.data.boleta){if(this.data.boletaImagen)return!0;this.notificacionService.presentToast("La imagen de la boleta es requerido.")}else this.notificacionService.presentToast("El No. de boleta es requerido.");return!1}create(){this.data.estado=this.data.tipoOrden,this.ventaService.create(this.data).subscribe(e=>{console.log(e),this.notificacionService.presentAlert("Compra Realizada","Su compra se ha registrado exitosamente."),this.router.navigate(["compras/buy"])},e=>{this.notificacionService.presentToast("Lo sentimos, ha ocurrido un error intenta m\xe1s tarde.")})}obtenerTotal(){let e=0,i=0;for(let t of this.cart)e=t.subtotal,i+=e;this.data.total=i.toFixed(2)}libreria(){this.procesarImagen({quality:60,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,correctOrientation:!0,sourceType:this.camera.PictureSourceType.PHOTOLIBRARY})}procesarImagen(e){this.camera.getPicture(e).then(e=>{this.strImage="https://i.pinimg.com/originals/8e/e2/12/8ee212dac057d412972e0c8cc164deee.gif",this.uploadFileService.subirImagen(e,"Ecommerce/Venta").then(e=>{this.strImage=e.secure_url}).catch(e=>{this.notificacionService.presentToast("Lo sentimos, ha ocurrido un error intenta m\xe1s tarde.")})},e=>{this.notificacionService.presentToast("Lo sentimos, servicio inhabilitado para tu dispositivo.")})}}return e.\u0275fac=function(i){return new(i||e)(r.Jb(s.a),r.Jb(b.a),r.Jb(l.a),r.Jb(d.a),r.Jb(u.a),r.Jb(n.f),r.Jb(c.g))},e.\u0275cmp=r.Db({type:e,selectors:[["app-compra"]],decls:54,vars:12,consts:[["translucent","true"],["slot","start"],["defaultHref","/cliente/categoria"],["collapse","true","slot","end"],[3,"click"],["slot","icon-only","name","locate-outline"],["collapse","condense"],["size","large"],["slot","end"],[2,"width","100%","height","350px"],[1,"container"],["class","img-center","src","https://res.cloudinary.com/devgea-s-a/image/upload/v1594950613/Finca%20Cienaguilla/mkdr6jfwkclzdzubuuwb.png",4,"ngIf"],["class","img-center",3,"src",4,"ngIf"],[3,"ngSubmit"],["position","floating"],["name","document-outline"],["type","text","name","nit","required","true","maxlength","255",3,"ngModel","ngModelChange"],["name","map-outline"],["placeholder","Selecciona una direcci\xf3n","name","direccion",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","cart-outline"],["placeholder","Selecciona un tipo de pago","name","tipoOrden",3,"ngModel","ngModelChange"],[4,"ngIf"],["name","chatbubble-ellipses-outline"],["type","text","rows","6","cols","20","name","observaciones","required","true","maxlength","255",3,"ngModel","ngModelChange"],["name","cash-outline"],["type","number","name","total","required","true","maxlength","10","disabled","",3,"ngModel","ngModelChange"],["color","primary","expand","block","type","button",3,"click",4,"ngIf"],["color","primary","expand","block","type","submit",3,"disabled"],["name","save-outline","slot","start"],["src","https://res.cloudinary.com/devgea-s-a/image/upload/v1594950613/Finca%20Cienaguilla/mkdr6jfwkclzdzubuuwb.png",1,"img-center"],[1,"img-center",3,"src"],[3,"value"],["name","document-text-outline"],["type","number","name","boleta","required","true","maxlength","10",3,"ngModel","ngModelChange"],["color","primary","expand","block","type","button",3,"click"],["name","images-outline","slot","start"]],template:function(e,i){1&e&&(r.Mb(0,"ion-header",0),r.Mb(1,"ion-toolbar"),r.Mb(2,"ion-buttons",1),r.Kb(3,"ion-back-button",2),r.Lb(),r.Mb(4,"ion-title"),r.ic(5,"Compra"),r.Lb(),r.Mb(6,"ion-buttons",3),r.Mb(7,"ion-button",4),r.Ub("click",(function(){return i.goToRoute("direccion")})),r.Kb(8,"ion-icon",5),r.Lb(),r.Lb(),r.Lb(),r.Lb(),r.Mb(9,"ion-content"),r.Mb(10,"ion-header",6),r.Mb(11,"ion-toolbar"),r.Mb(12,"ion-title",7),r.ic(13,"Compra"),r.Lb(),r.Mb(14,"ion-buttons",8),r.Mb(15,"ion-button",4),r.Ub("click",(function(){return i.goToRoute("direccion")})),r.Kb(16,"ion-icon",5),r.Lb(),r.Lb(),r.Lb(),r.Lb(),r.Mb(17,"div",9),r.Mb(18,"div",10),r.hc(19,g,1,0,"img",11),r.hc(20,h,1,1,"img",12),r.Lb(),r.Lb(),r.Mb(21,"form",13),r.Ub("ngSubmit",(function(){return i.saveChanges()})),r.Mb(22,"ion-item"),r.Mb(23,"ion-label",14),r.Kb(24,"ion-icon",15),r.ic(25," No. NIT: "),r.Lb(),r.Mb(26,"ion-input",16),r.Ub("ngModelChange",(function(e){return i.data.nit=e})),r.Lb(),r.Lb(),r.Mb(27,"ion-item"),r.Mb(28,"ion-label"),r.Kb(29,"ion-icon",17),r.ic(30," Direcci\xf3n: "),r.Lb(),r.Mb(31,"ion-select",18),r.Ub("ngModelChange",(function(e){return i.data.direccion=e})),r.hc(32,p,2,2,"ion-select-option",19),r.Lb(),r.Lb(),r.Mb(33,"ion-item"),r.Mb(34,"ion-label"),r.Kb(35,"ion-icon",20),r.ic(36," Tipo de Pago: "),r.Lb(),r.Mb(37,"ion-select",21),r.Ub("ngModelChange",(function(e){return i.data.tipoOrden=e})),r.hc(38,m,2,2,"ion-select-option",19),r.Lb(),r.Lb(),r.hc(39,f,5,1,"ion-item",22),r.Mb(40,"ion-item"),r.Mb(41,"ion-label",14),r.Kb(42,"ion-icon",23),r.ic(43," Observaciones: "),r.Lb(),r.Mb(44,"ion-textarea",24),r.Ub("ngModelChange",(function(e){return i.data.observaciones=e})),r.Lb(),r.Lb(),r.Mb(45,"ion-item"),r.Mb(46,"ion-label",14),r.Kb(47,"ion-icon",25),r.ic(48," Total: "),r.Lb(),r.Mb(49,"ion-input",26),r.Ub("ngModelChange",(function(e){return i.data.total=e})),r.Lb(),r.Lb(),r.hc(50,M,3,0,"ion-button",27),r.Mb(51,"ion-button",28),r.Kb(52,"ion-icon",29),r.ic(53," Guardar Cambios "),r.Lb(),r.Lb(),r.Lb()),2&e&&(r.zb(19),r.bc("ngIf",!i.strImage),r.zb(1),r.bc("ngIf",i.strImage),r.zb(6),r.bc("ngModel",i.data.nit),r.zb(5),r.bc("ngModel",i.data.direccion),r.zb(1),r.bc("ngForOf",i.direcciones),r.zb(5),r.bc("ngModel",i.data.tipoOrden),r.zb(1),r.bc("ngForOf",i.tipoDePago),r.zb(1),r.bc("ngIf",2==i.data.tipoOrden),r.zb(5),r.bc("ngModel",i.data.observaciones),r.zb(5),r.bc("ngModel",i.data.total),r.zb(1),r.bc("ngIf",2==i.data.tipoOrden),r.zb(1),r.bc("disabled",i.disabledBtn))},directives:[a.t,a.Q,a.h,a.e,a.f,a.P,a.g,a.u,a.o,n.i,o.j,o.f,o.g,a.w,a.y,a.v,a.ab,o.i,o.b,o.e,o.h,a.G,a.Z,n.h,a.O,a.X,a.H],styles:["ion-content[_ngcontent-%COMP%]{--padding-start:15px;--padding-end:15px}"]}),e})()}];let L=(()=>{class e{}return e.\u0275mod=r.Hb({type:e}),e.\u0275inj=r.Gb({factory:function(i){return new(i||e)},imports:[[c.i.forChild(v)],c.i]}),e})(),y=(()=>{class e{}return e.\u0275mod=r.Hb({type:e}),e.\u0275inj=r.Gb({factory:function(i){return new(i||e)},imports:[[n.b,o.a,a.R,L]]}),e})()}}]);